"use strict";(self.webpackChunkspa=self.webpackChunkspa||[]).push([[369],{9369:(V,u,i)=>{i.r(u),i.d(u,{TodoModule:()=>z});var _=i(7390),h=i(9808),l=i(3075),y=i(6276),Z=i(7113),g=i(7038),M=i(5813),c=i(7489),A=i(1135),S=i(2542),f=i(2340),t=i(5e3);let C=(()=>{class n{constructor(o){this.authService=o,this.userAuthChange$=new A.X({}),this.userAuthCurrentState=this.userAuthChange$.asObservable(),this.supabaseClient=(0,M.eI)(f.N.supabaseUrl,f.N.supabaseKey),this.supabaseClient.auth.onAuthStateChange((e,s)=>{this.userAuthChange$.next({event:e,session:s})})}fetchTodos(){const o=(0,c.get)(this.authService.user,["id"],null);return this.supabaseClient.from("todos").select("*").eq("user_id",o).order("id",{ascending:!1})}addTodo(o){const e=(0,c.get)(this.authService.user,["id"],null);return this.supabaseClient.from("todos").insert({task:o,user_id:e}).single()}toggleComplete(o,e){return this.supabaseClient.from("todos").update({is_complete:e}).eq("id",o).single()}deleteTodo(o){return this.supabaseClient.from("todos").delete().eq("id",o)}}return n.\u0275fac=function(o){return new(o||n)(t.LFG(S.e))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var p=i(655),m=i(6204),j=i(1120),v=i(7346);const w=[(0,v.d)([(0,v.u)({key:"task",label:"Task name",templateOptions:{required:!0}})])];var T=i(9783),D=i(7307),J=i(4297),O=i(4534),N=i(1424),k=i(845),b=i(8952),x=i(1208),U=i(4119),F=i(5315);function P(n,r){if(1&n){const o=t.EpF();t._UZ(0,"label",17),t.TgZ(1,"input",18,19),t.NdJ("input",function(s){return t.CHM(o),t.oxw(),t.MAs(12).filterGlobal(s.target.value,"contains")}),t.qZA()}}function Y(n,r){if(1&n){const o=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){return t.CHM(o),t.oxw().showMdlHandler(null,"new")}),t.qZA(),t.TgZ(1,"button",21),t.NdJ("click",function(){t.CHM(o);const s=t.oxw(),a=t.MAs(12);return a.filterGlobal("","contains"),s.ClearTblCat(a)}),t.qZA()}}function H(n,r){if(1&n&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&n){const o=r.$implicit;t.xp6(1),t.hij(" ",o.header," ")}}function B(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"th",22),t._uU(2),t.qZA(),t.YNc(3,H,2,1,"th",23),t.TgZ(4,"th",22),t._uU(5,"Action"),t.qZA()()),2&n){const o=r.$implicit;t.xp6(2),t.Oqu("#"),t.xp6(1),t.Q6J("ngForOf",o)}}function G(n,r){if(1&n){const o=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td")(6,"p-checkbox",24),t.NdJ("ngModelChange",function(s){return t.CHM(o).$implicit.is_complete=s})("onChange",function(s){const d=t.CHM(o).$implicit;return t.oxw().onChangeRow(s,d)}),t.qZA()(),t.TgZ(7,"td",25)(8,"button",26),t.NdJ("click",function(s){const d=t.CHM(o).$implicit;return t.oxw().onDeleteCmd(s,d)}),t.qZA()()()}if(2&n){const o=r.$implicit,e=r.rowIndex;t.xp6(2),t.hij(" ",e+1,""),t.xp6(2),t.Oqu(o.task),t.xp6(2),t.Q6J("value",o)("ngModel",o.is_complete)}}function $(n,r){if(1&n&&(t.TgZ(0,"div",27)(1,"form",28),t._UZ(2,"formly-form",29),t.qZA()()),2&n){const o=t.oxw();t.xp6(1),t.Q6J("formGroup",o.objCfg.form),t.xp6(1),t.Q6J("form",o.objCfg.form)("model",o.objCfg.model)("fields",o.objCfg.fields)}}function R(n,r){if(1&n){const o=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){return t.CHM(o),t.oxw().onSubmit()}),t.qZA(),t.TgZ(1,"button",31),t.NdJ("click",function(){return t.CHM(o),t.oxw().showDialog(!1)}),t.qZA()}if(2&n){const o=t.oxw();t.Q6J("disabled",!o.objCfg.form.valid)}}const E=function(){return{"margin-bottom":"2em",width:"100%"}},Q=function(){return{width:"800px"}},I=function(){return{"overflow-y":"auto","overflow-x":"hidden","max-height":"70vh","min-height":"200px"}};let X=(()=>{class n extends j.Z{constructor(o,e,s){super(),this.todoSvc=o,this.msgService=e,this.confirmPopUpSvc=s,this.urlResource="user/todo",this.componentTitle="Todos",this.loading=!1,this.todos=[],this.objCfg={fields:new Array,form:new l.cw({}),model:{id:0,task:"",is_complete:null},showDialog:!1},this.objAccount={profile:null,session:null}}ngOnInit(){this.cols=[{field:"task",header:"Task"},{field:"is_complete",header:"Done"}],this.objCfg.fields=[...w],this.fetchTodos()}fetchTodos(){return(0,p.mG)(this,void 0,void 0,function*(){let{data:o,error:e}=yield this.todoSvc.fetchTodos();e?console.error("error",e.message):this.todos=null!=o?o:[]})}onChangeRow(o,e){const s=(0,c.get)(o,["checked"],!1);this.toggleComplete(e.id,s)}toggleComplete(o,e){return(0,p.mG)(this,void 0,void 0,function*(){try{yield this.todoSvc.toggleComplete(o,e)}catch(s){console.error("toggleComplete ***",s)}})}handleDeleteTodo(o){return(0,p.mG)(this,void 0,void 0,function*(){try{yield this.todoSvc.deleteTodo(o),this.todos=this.todos.filter(e=>e.id!==o)}catch(e){console.error("handleDeleteTodo ***",e)}})}onDeleteCmd(o,e){this.confirmPopUpSvc.confirm(Object.assign(Object.assign({},this.msgService.confirmPopOverWrap()),{key:"popup-todos",target:o.target,accept:()=>{this.handleDeleteTodo(e.id)}}))}showMdlHandler(o,e){this.showDialog(!0)}showDialog(o){this.objCfg.showDialog=o}onSubmit(){return(0,p.mG)(this,void 0,void 0,function*(){if(this.objCfg.form.valid){let{data:o,error:e}=yield this.todoSvc.addTodo((0,c.get)(this.objCfg.model,["task"],"New Task"));e?this.informUserError(e.message):(this.todos=[o,...this.todos],this.msgService.add(m.n.SUCCESS,"Todos","New Todo Added"),this.resetForm())}})}resetForm(){this.objCfg.form.reset()}informUserError(o){this.loading=!1,this.msgService.add(m.n.ERROR,"Service Message",o)}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(C),t.Y36(m.o),t.Y36(T.YP))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-todo"]],features:[t.qOj],decls:18,vars:15,consts:[[3,"key"],[3,"header"],[1,"cstm-card"],[1,"p-grid"],[1,"p-col-12","p-sm-12"],["styleClass","p-mb-5"],["pTemplate","left"],["pTemplate","right"],[1,"p-grid",2,"margin-top","-20px"],[2,"width","100%"],["responsiveLayout","scroll",1,"tblStyle",3,"columns","value"],["dt",""],["pTemplate","header"],["pTemplate","body"],["styleClass","p-fluid",3,"visible","header","modal","contentStyle","visibleChange"],["pTemplate","content","closable","false"],["pTemplate","footer"],["for","search"],["type","text","id","search","pInputText","","placeholder","Buscar...",2,"width","auto","font-size",".8em !important",3,"input"],["inputBar",""],["pButton","","type","button","icon","pi pi-plus",1,"p-button-text","p-button-raised",3,"click"],["pButton","","type","button","icon","pi pi-filter-slash",1,"p-button-text","p-button-raised",2,"margin-left","10px",3,"click"],["scope","col"],[4,"ngFor","ngForOf"],["binary","true",3,"value","ngModel","ngModelChange","onChange"],[2,"text-align","center"],["pButton","","pRipple","","icon","pi pi-trash","pTooltip","Delete","tooltipPosition","top","styleClass","p-button-sm",1,"p-button-rounded","p-button-secondary","p-button-text",3,"click"],[1,"p-grid","frm-dialog","card"],[3,"formGroup"],[3,"form","model","fields"],["pButton","","pRipple","","label","Guardar","icon","pi pi-check","type","submit",1,"p-button-text","p-button-rounded","p-button-raised",3,"disabled","click"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-times","type","reset",1,"p-button-text","p-button-rounded","p-button-raised","p-ml-2",3,"click"]],template:function(o,e){1&o&&(t._UZ(0,"p-confirmPopup",0),t.TgZ(1,"p-card",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"p-toolbar",5),t.YNc(6,P,3,0,"ng-template",6),t.YNc(7,Y,2,0,"ng-template",7),t.qZA()()(),t.TgZ(8,"div",8)(9,"p-card",9)(10,"div",3)(11,"p-table",10,11),t.YNc(13,B,6,2,"ng-template",12),t.YNc(14,G,9,4,"ng-template",13),t.qZA()()()()()(),t.TgZ(15,"p-dialog",14),t.NdJ("visibleChange",function(a){return e.objCfg.showDialog=a}),t.YNc(16,$,3,4,"ng-template",15),t.YNc(17,R,2,1,"ng-template",16),t.qZA()),2&o&&(t.Q6J("key","popup-todos"),t.xp6(1),t.Akn(t.DdM(12,E)),t.s9C("header",e.componentTitle),t.xp6(10),t.Q6J("columns",e.cols)("value",e.todos),t.xp6(4),t.Akn(t.DdM(13,Q)),t.Q6J("visible",e.objCfg.showDialog)("header","Todos")("modal",!0)("contentStyle",t.DdM(14,I)))},directives:[D.P,J.Z,O.o,T.jx,N.o,k.Hq,b.iA,h.sg,x.XZ,l.JJ,l.On,U.u,F.V,l._Y,l.JL,l.sg,g.T7],styles:["[_nghost-%COMP%]     .p-card .p-card-footer{text-align:-webkit-right}[_nghost-%COMP%]     .avatar{border-radius:var(--custom-border-radius);overflow:hidden;max-width:100%}[_nghost-%COMP%]     .avatar.image{-o-object-fit:cover;object-fit:cover}[_nghost-%COMP%]     .avatar.no-image{background-color:#333;border:1px solid #c8c8c8;border-radius:5px}[_nghost-%COMP%]     .tblStyle{width:100%!important;table-layout:fixed}.frm-dialog[_ngcontent-%COMP%]{width:100%!important;min-height:150px!important;margin-top:10px!important}.cstm-card[_ngcontent-%COMP%]{box-shadow:none!important;min-height:95vh!important;width:100%}"]}),n})(),z=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[C],imports:[[_.Bz.forChild([{path:"",component:X}]),y.h,h.ez,l.u5,l.UX,Z.x,g.X0,b.U$,x.nD]]}),n})()}}]);